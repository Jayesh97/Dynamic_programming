#### purpose of link local address when it is not routed

To summarize these rules:

    An entire string of zeros can be removed, you can only do this once.
    4 zeros can be removed, leaving only a single zero.
    Leading zeros can be removed.

Let’s work on an example…let’s say that we have a LAN and we want to use unique local IPv6 addresses and we require 10 subnets:

* The prefix starts with FD.

* We have 40 bits for the global ID, each hexadecimal character represents 4 bits so we can pick 10 hexadecimal characters. Let’s use AB:1234:5678 as the global ID.

* Our first subnet will start with 0000.

## link local

Link-local addresses are something new in IPv6. As the wording implies, these addresses only work on the local link, we never route these addresses. These addresses are used to send and receive IPv6 packets on a single subnet.

When you enable IPv6 on an interface then the device will automatically create a link-local address. We use the link-local address for things like neighbor discovery (the replacement for ARP) and next hop address for routes in your routing table

These link-local addresses however are automatically generated by the host which sets the 54 bits to zeroes. This means that normally you will only see link-local addresses that start with FE80.

last 64 bits - EuID

We use the FE80::/10 range for link-local addresses

## site local

The site local range was originally meant to be the “private range” for IPv6. It has been deprecated though and nowadays we use the unique local addresses instead. For these addresses we used the FEC0::/10 range (1111 1110 11 in binary)

## Unspecified

The 0:0:0:0:0:0:0:0 address is called the unspecified address, :: is the shortened version of this address. It should never be configured on a host and is used to indicate that the host doesn’t have any address.

## Loopback

the 0:0:0:0:0:0:0:1 address is called the loopback address, the short version is ::1. IPv6 devices can use this to send an IPv6 packet to themselves which is typically used for testing. It should never be assigned to any physical interfaces

## Multicast

FF02::1 – all nodes on local network segment.
FF02::2 – all routers on local network segment.
FF02::5 – all OSPFv3 routers.
FF02::6 – all OSPFv3 DR routers.
FF02::9 – RIPng routers
FF02::A – EIGRP routers

The first 8 bits indicates that we have a multicast address. The next 4 bits are used to set flags, these are used for some special things like embedded RP. The scope bits are used to tell the “scope” of this multicast traffic. You can use this to indicate that the multicast traffic should be restricted to link-local, organization local or global (Internet).


## Anycast

When you send a packet to an anycast address then it will be delivered to the closest interface
There is no specifix prefix for anycast addresses. Any unicast address that you use on more than one device is suddenly an anycast address. The only difference is that you have to configure the device and tell that the address will be used for anycast.

## Global Unicast

IANA is using the 2000::/3 prefix for global unicast address space.

## IPV6-EUI 64

See the C000:18FF:FE5C:0 part above? That’s the MAC address that is split in 2, FFFE in the middle and the “2” in “C200” of the MAC address has been inverted which is why it now shows up as “C000”.

## ipv6 summerization

Let’s start with a simple example:

2001:DB8:1234:ABA2::/64
2001:DB8:1234:ABC3::/64

2001:DB8:1234:AB80::/57 - answer

## global prefix

You have now learned how to use the IPv6 general prefix feature to automatically configure the global prefix and renumber your interfaces if needed

## ipv6 solicited node multicast address

Every device that uses an IPv6 address will also compute and join a solicited node multicast group address. This address is required for IPv6 Neighbor Discovery which we use for layer two address discovery.

All solicited node multicast group addresses start with FF02::1:FF /104

I can configure multiple IPv6 addresses on the interface, if the last 6 hexadecimal characters are similar then there is no need to join another multicast address.

# Neighbour Discovery

ND uses ICMP and solicited node multicast addresses to discover the layer 2 address of other IPv6 hosts the same network (local link)

* Neighbor solicitation message
* Neighbor advertisement message

## IPv6 Neighbor Solicitation Message

The neighbor solicitation message is used primarily to find the layer two address of another IPv6 address on the local link, it’s also used for DAD (Duplicated Address Detection)

Every IPV6 device will compute a solicited node multicast address by taking the multicast group address (FF02::1:FF /104) and adding the last 6 hexadecimal characters from its IPv6 address. It will then join this multicast group address and “listens” to it.

The result will be that only the remote host will receive the neighbor solicitation. That’s far more efficient than a broadcast that is received by everyone

Neighbor solicitation messages are also used to check if a remote host is reachable. In this case, the destination address will be the unicast address of the remote host.

### make sure u know all nodes multicast add vs solicitated node multicast address

Neighbor advertisement messages are also used when the layer two address of a host changes. When this message is sent, the destination address will be the all-nodes multicast address.

### how will switch know to stop the multicast

As you can see the layer two destination address is a multicast address. When a switch receives this it will flood it out all of its interfaces. That’s a bad idea since it defeats the purpose of our solicited node multicast addresses. For this reason, we should enable MLD snooping on our switch.

# IPv6 stateless autoconfiguration - which IP address link local or?? - i think its link local

IPv6 uses the NDP (Neighbor Discovery Protocol) and one of the things this protocol offers is RS (Route Solicitation and (RA) Router Advertisement messages that help an IPv6 device to automatically configure an IPv6 address

We need to enable ipv6 address autoconfig on R1 to make sure it generates its own IPv6 address.

Here you can see R2 sending the router advertisement with the prefix.

The big difference between DHCP for IPv4 and DHCPv6 is that we don’t use broadcast traffic anymore. When an IPv6 device is looking for a DHCPv6 server it will send multicast packets to FF02::1:2. Routers will forward these packets to DHCP servers.

### what if multiple routers in the network


When your IPv6 hosts receive multiple router advertisements, you probably want to decided yourself which router advertisement will be used. By setting the preference, this can be accomplished.

# DHCPv6

First of all, DHCPv6 supports two different methods:

Stateful configuration - The stateful version of DHCPv6 is pretty much the same as for IPv4
Stateless configuration (also known as SLAAC…StateLess AutoConfiguration)

Stateless works a bit different…the DHCPv6 server does not assign IPv6 addresses to the DHCPv6 clients, this is done through autoconfiguration. The DHCPv6 server is only used to assign information that autoconfiguration doesn’t….stuff like a domain-name, multiple DNS servers and all the other options that DHCP has to offer.

The other difference is the number of messages that DHCPv6 uses:

Normal: 4 messages called solicit, advertise, request and reply.
Rapid: 2 messages, only solicit and reply

the rapid mode is useful in “high mobility” networks where clients come and go often


### DHCP Stateless config

The ipv6 nd other-config-flag is required as it will inform clients through RA (Router Advertisement) messages that they have to use DHCPv6 to receive extra information like the domain name and DNS server after they used autoconfiguration.








